<!DOCTYPE html>
<html lang="en" class="h-full">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Workout Timer</title>
    <meta name="description" content="Configurable workout interval timer (EMOM, Tabata, HIIT, Custom)" />
    <link rel="preconnect" href="https://cdn.jsdelivr.net" />
    <script src="https://cdn.tailwindcss.com?plugins=typography"></script>
    <link rel="stylesheet" href="styles.css" />
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='0.9em' font-size='90'>‚è±Ô∏è</text></svg>">
    <meta name="theme-color" content="#0f172a" />
    <style>
        /* Tailwind config override (inline for simplicity) */
        :root {
            color-scheme: dark light;
        }
    </style>
</head>

<body class="h-full bg-slate-900 text-slate-100 font-sans antialiased selection:bg-emerald-500/40 flex flex-col">

    <main class="flex-1 flex flex-col justify-center items-center w-full max-w-5xl mx-auto px-4 pb-4" id="appRoot">
        <!-- UI Scale Controls -->
        <div id="uiScaleControls" class="ui-scale-controls" aria-label="UI size controls">
            <button id="scaleMinusBtn" type="button" class="btn-subtle text-xs" title="Smaller" aria-label="Decrease UI size">A‚Äì</button>
            <button id="scaleResetBtn" type="button" class="btn-subtle text-xs" title="Reset" aria-label="Reset UI size">A</button>
            <button id="scalePlusBtn" type="button" class="btn-subtle text-xs" title="Larger" aria-label="Increase UI size">A+</button>
            <span id="scaleValue" class="ml-2 text-[10px] text-slate-400" aria-live="polite">100%</span>
        </div>
        <!-- Screen: Select Type -->
        <section id="screenSelect" class="screen active w-full flex flex-wrap justify-center items-start gap-6 pt-4" aria-labelledby="selectHeading">
            <h2 id="selectHeading" class="sr-only">Select Workout Type</h2>
            <div class="w-full max-w-4xl order-first">
                <div class="flex flex-row sm:flex-row gap-3 items-stretch mb-2">
                    <div class="flex-1 min-w-[12rem]">
                        <input id="importUrlInput" type="url" placeholder="Import From URL / Query - Paste URL here..." class="import-input w-full field px-4 py-3 rounded-md bg-slate-800/70 border border-slate-700 focus:outline-none focus:ring-2 focus:ring-emerald-500 text-xs" aria-label="URL to import workout configuration from" />
                    </div>
                    <button id="importUrlBtn" type="button" class="btn-secondary self-center sm:self-auto " title="Load configuration from URL" aria-label="Import workout configuration from URL">Load</button>
                </div>
                <p id="importStatus" class="text-[10px] tracking-wide text-slate-500 h-4"></p>
                <!-- Quick Presets -->
                <div class="mt-4 quick-presets">
                    <h3 class="text-sm font-semibold text-slate-300 mb-2">Quick Presets</h3>
                    <div class="grid grid-cols-2 sm:grid-cols-6 gap-3">
                        <button data-preset="tabata3" class="card card-select group w-full" type="button" title="Load 3 Tabatas in a row">
                            <div class=" gap-2 text-center">
                                <span class="text-2xl">üî•√ó3 Tabatas</span>
                                <p class="text-xs text-slate-400 leading-snug">3 √ó (8 rounds 20/10). Between sets: 10s (~12:00 total)</p>
                            </div>
                        </button><button data-preset="tabata5" class="card card-select group w-full" type="button" title="Load 5 Tabatas in a row">
                            <div class=" gap-2 text-center">
                                <span class="text-2xl">üî•√ó5 Tabatas</span>
                                <p class="text-xs text-slate-400 leading-snug">5 √ó (8 rounds 20/10). Between sets: 10s (~24:00 total)</p>
                            </div>
                        </button>
                        <button data-preset="emom10x60" class="card card-select group w-full" type="button" title="Load 10-minute EMOM (60s work)">
                            <div class=" gap-2 text-center">
                                <span class="text-2xl">‚è≤Ô∏èEMOM-10</span>
                                <p class="text-xs text-slate-400 leading-snug">10 rounds ‚Ä¢ 60s work per minute ‚Ä¢ No rest (~10:00 total)</p>
                            </div>
                        </button>
                        <button data-preset="micro100x4" class="card card-select group w-full" type="button" title="Load Micro: 100 burpees (1 every 4s)">
                            <div class=" gap-2 text-center">
                                <span class="text-2xl">üéØMicro: 100x4</span>
                                <p class="text-xs text-slate-400 leading-snug">100 reps ‚Ä¢ 4s interval (~6:40 total)</p>
                            </div>
                        </button>
                        <button data-preset="hiit10x45_15_60_30" class="card card-select group w-full" type="button" title="Load HIIT: 10 rounds (45s work, 15s rest) + warmup/cooldown">
                            <div class=" gap-2 text-center">
                                <span class="text-2xl">‚ö°HIIT: 10x45/15</span>
                                <p class="text-xs text-slate-400 leading-snug">10 √ó (45s work, 15s rest) + 60s warmup + 30s cooldown (~11:00 total)</p>
                            </div>
                        </button>
                        <button data-preset="hiit10x40_20_30_30" class="card card-select group w-full" type="button" title="Load HIIT: 10 rounds (40s work, 20s rest) + warmup/cooldown">
                            <div class=" gap-2 text-center">
                                <span class="text-2xl">‚ö°HIIT: 10x40/20</span>
                                <p class="text-xs text-slate-400 leading-snug">10 √ó (40s work, 20s rest) + 30s warmup + 30s cooldown (~11:00 total)</p>
                            </div>
                        </button>
                    </div>
                </div>
            </div>
            <button data-type="emom" class="card card-select group w-full sm:w-auto sm:max-w-xs" type="button">
                <div class="flex flex-col gap-2 text-center sm:text-center">
                    <span class="text-2xl">‚è≤Ô∏è</span>
                    <span class="font-semibold text-lg">EMOM</span>
                    <p class="text-xs text-slate-400 leading-snug">Every minute start a new work segment. Configure work seconds inside the minute.</p>
                </div>
            </button>
            <button data-type="tabata" class="card card-select group w-full sm:w-auto sm:max-w-xs" type="button">
                <div class="flex flex-col gap-2 text-center sm:text-center">
                    <span class="text-2xl">üî•</span>
                    <span class="font-semibold text-lg">Tabata</span>
                    <p class="text-xs text-slate-400 leading-snug">Classic 20s work / 10s rest intervals. Adjustable rounds & durations.</p>
                </div>
            </button>
            <button data-type="hiit" class="card card-select group w-full sm:w-auto sm:max-w-xs" type="button">
                <div class="flex flex-col gap-2 text-center sm:text-center">
                    <span class="text-2xl">‚ö°</span>
                    <span class="font-semibold text-lg">HIIT</span>
                    <p class="text-xs text-slate-400 leading-snug">High intensity intervals with warmup / cooldown support.</p>
                </div>
            </button>
            <button data-type="custom" class="card card-select group w-full sm:w-auto sm:max-w-xs" type="button">
                <div class="flex flex-col gap-2 text-center sm:text-center">
                    <span class="text-2xl">üõ†Ô∏è</span>
                    <span class="font-semibold text-lg">Custom</span>
                    <p class="text-xs text-slate-400 leading-snug">Full control over prep, work, rests, and between-round recovery.</p>
                </div>
            </button>
            <!-- New Micro Type Card -->
            <button data-type="micro" class="card card-select group w-full sm:w-auto sm:max-w-xs" type="button">
                <div class="flex flex-col gap-2 text-center sm:text-center">
                    <span class="text-2xl">üéØ</span>
                    <span class="font-semibold text-lg">Micro</span>
                    <p class="text-xs text-slate-400 leading-snug">Repeat a tiny fixed interval for many reps (e.g. 5s √ó 100).</p>
                </div>
            </button>
            <!-- New Countdown Type Card -->
            <button data-type="countdown" class="card card-select group w-full sm:w-auto sm:max-w-xs" type="button">
                <div class="flex flex-col gap-2 text-center sm:text-center">
                    <span class="text-2xl">‚è≥</span>
                    <span class="font-semibold text-lg">Timer</span>
                    <p class="text-xs text-slate-400 leading-snug">Simple countdown ‚Äî set a max time and go.</p>
                </div>
            </button>
        </section>

        <!-- Screen: Configure -->
        <section id="screenConfig" class="screen hidden w-full max-w-2xl mx-auto grid gap-4" aria-labelledby="configHeading">
            <div class="space-y-2">
                <div class="card">
                    <div class="flex flex-col gap-4">
                        <div>
                            <select id="workoutType" class="field" aria-label="Select workout type">
                                <option value="emom">EMOM (Every Minute On the Minute)</option>
                                <option value="tabata">Tabata</option>
                                <option value="hiit">HIIT</option>
                                <option value="custom">Custom</option>
                                <option value="micro">Micro (Tiny Fixed Interval)</option>
                                <option value="countdown">Timer (Countdown)</option>
                            </select>
                            <p id="typeHelp" class="sr-only">Select the type of workout to configure.</p>
                        </div>

                        <!-- Dynamic form fields injected here -->
                        <div id="dynamicFields" class="grid gap-6"></div>

                        <div class="flex flex-wrap items-center gap-4 pt-2 border-t border-slate-700">
                            <div class="flex items-baseline gap-2 text-sm">
                                <span class="text-slate-400">Total</span>
                                <strong id="totalDuration" class="font-semibold">00:00</strong>
                            </div>
                            <div class="flex items-baseline gap-2 text-sm">
                                <span class="text-slate-400">Rounds</span>
                                <strong id="roundCount" class="font-semibold">0</strong>
                            </div>
                            <div class="ml-auto flex gap-2">
                                <button id="copyLinkBtn" type="button" class="btn-subtle" title="Copy shareable URL" aria-label="Copy shareable URL">Copy URL</button>
                                <button id="savePresetBtn" type="button" class="btn-subtle" title="Save current configuration as preset" aria-label="Save current configuration as preset">Save Preset</button>
                                <select id="presetSelect" class="field text-xs max-w-[15rem] min-w-[8rem]" title="Load preset" aria-label="Select a saved preset"></select>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="flex gap-3 justify-center">
                    <button id="backToSelectBtn" type="button" class="btn-subtle btn-warning">Back to Main</button>
                    <button id="goToTimerBtn" type="button" class="btn-primary">Continue to Timer</button>
                </div>
                <div class="card" aria-labelledby="previewHeading">
                    <h2 id="previewHeading" class="text-lg font-semibold mb-3">Sequence Preview</h2>
                    <ol id="sequencePreview" class="text-xs md:text-sm space-y-1 max-h-60 overflow-auto pr-1" aria-live="polite" aria-label="Upcoming intervals"></ol>
                </div>

            </div>
        </section>

        <!-- Screen: Timer -->
        <section id="screenTimer" class="screen hidden w-full max-w-3xl mx-auto space-y-6" aria-labelledby="timerHeading">

            <div class="grid gap-4">
                <div class="space-y-6">
                    <div class="card relative overflow-hidden isolate">
                        <div class="absolute inset-0 pointer-events-none timer-bg-glow"></div>
                        <header id="timerHeading" class="flex flex-col sm:flex-row sm:items-end gap-2 mb-4 pointer-events-none select-none absolute top-4 left-4 z-10">
                            <span class="sr-only">Current Interval</span>
                            <div class="flex gap-2 text-xs" id="statusBadges"></div>
                        </header>

                        <div class="grid gap-6 sm:gap-8">
                            <div class="text-center space-y-3 flex flex-col items-center">
                                <p id="intervalLabel" class="intervalLabel uppercase tracking-wider text-emerald-400 font-medium text-xs">Ready</p>
                                <div id="timer" class="timer-dial" aria-label="Current time remaining in workout">
                                    <span id="mainTime" class="font-mono timer-digits tabular-nums">00:00</span>
                                </div>
                                <p id="roundInfo" class="round-info" aria-label="Current round and phase information"></p>
                                <p id="nextInterval" class="text-[11px] text-slate-500 h-4" aria-live="polite"></p>
                            </div>

                            <div class="timer-button-bar flex flex-wrap justify-center gap-4">
                                <button id="startBtn" class="btn-primary" type="button" title="Start workout (Space)" aria-label="Start workout">Start</button>
                                <button id="pauseBtn" class="btn-secondary" type="button" title="Pause workout (Space)" aria-label="Pause workout">Pause</button>
                                <button id="skipBtn" class="btn-subtle" type="button" disabled>Skip</button>
                                <button id="markBtn" class="btn-subtle ml-10" type="button" title="Mark current time" aria-label="Mark current time">üìå Mark</button>
                            </div>
                            <div class="flex items-center justify-center gap-4 text-xs text-slate-400">
                                <label class="inline-flex items-center gap-1">
                                    <input type="checkbox" id="soundToggle" class="accent-emerald-500" checked /> Sound
                                </label>
                                <label class="inline-flex items-center gap-1">
                                    <input type="checkbox" id="voiceToggle" class="accent-emerald-500" aria-label="Enable voice announcements" /> Voice Cues
                                </label>
                                <label class="inline-flex items-center gap-1">
                                    <input type="checkbox" id="autoRestartToggle" class="accent-emerald-500" /> Auto-Restart
                                </label>
                                <label class="inline-flex items-center gap-1">
                                    <input id="beepCheck" type="checkbox" class="checkbox" aria-label="Enable beep sounds" />
                                    Beep
                                </label>
                            </div>
                            <div id="progressBarWrapper" class="h-3 mx-auto bg-slate-800/70 rounded-full overflow-hidden shadow-inner">
                                <div id="progressBar" class="h-full w-0 bg-gradient-to-r from-emerald-500 to-teal-400 transition-[width] duration-100 linear" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" aria-label="Workout progress"></div>
                            </div>
                        </div>
                    </div>
                    <div class="flex gap-3" id="timerTopBar">
                        <button id="timerBackBtn" class="btn-subtle btn-warning" type="button">Back to Config</button>
                        <button id="timerCopyBtn" class="btn-subtle" type="button" title="Copy shareable URL for this workout" aria-label="Copy shareable URL for this workout">Copy URL</button>
                        <span class="ml-auto">
                            <button id="resetBtn" class="btn-secondary ml-auto" type="button" title="Reset workout" aria-label="Reset workout">Reset</button>
                            <button id="timerRestartBtn" class="btn-secondary ml-auto" type="button" title="Rebuild & restart">Restart</button>
                        </span>
                    </div>
                    <div class="card" aria-labelledby="logHeading">
                        <h2 id="logHeading" class="text-lg font-semibold mb-3">Rounds Log</h2>
                        <ul id="roundLog" class="text-xs md:text-sm space-y-1 max-h-56 overflow-auto pr-1 font-mono" aria-live="off"></ul>
                    </div>
                </div>
                <div class="space-y-6">
                    <div class="card">
                        <h3 class="text-lg font-semibold mb-3">Configuration Summary</h3>
                        <ul id="configSummary" class="text-xs md:text-sm space-y-1"></ul>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <footer class="w-full max-w-5xl mx-auto px-4 pb-8 text-center text-[10px] text-slate-500 flex-shrink-0">
        <p>Workout Timer ‚Äì by <u><a href="https://github.com/Freudenberger" target="_blank" rel="noopener noreferrer">Freudenberger</a></u></p>
    </footer>

    <div id="liveRegion" class="sr-only" aria-live="assertive" aria-atomic="true"></div>
    <!-- Modal Root -->
    <div id="modalRoot" class="fixed inset-0 z-50 hidden" aria-modal="true" role="dialog" aria-labelledby="modalTitle" aria-describedby="modalMessage">
        <div class="absolute inset-0 bg-slate-900/70 backdrop-blur-sm"></div>
        <div class="relative mx-auto mt-32 w-[min(92%,420px)] bg-slate-800 rounded-xl shadow-xl ring-1 ring-slate-700/60 p-6 flex flex-col gap-5 animate-fade-in">
            <div>
                <h2 id="modalTitle" class="text-lg font-semibold tracking-tight">Confirm</h2>
                <p id="modalMessage" class="mt-2 text-sm text-slate-300"></p>
            </div>
            <div id="modalExtra" class="text-xs text-slate-400 hidden"></div>
            <div class="flex justify-end gap-3 pt-2">
                <button id="modalCancel" class="btn-subtle" type="button">Cancel</button>
                <button id="modalOk" class="btn-primary" type="button">OK</button>
            </div>
        </div>
    </div>
    <div id="toast" class="fixed bottom-4 right-4 bg-emerald-500 text-slate-100 px-4 py-2 rounded-md shadow-lg opacity-0 transition-opacity duration-300 pointer-events-none z-50" aria-live="polite" aria-atomic="true"></div>
    <script src="timer.js"></script>
</body>

</html>